const Knowledge = {
    // --- ENGLISH ---
    "science day": "National Science Day is celebrated in India every year on February 28th. It commemorates the discovery of the 'Raman Effect' by the legendary Indian physicist Sir C.V. Raman in 1928. This discovery earned him the Nobel Prize in Physics in 1930.",
    "why we celebrate": "We celebrate National Science Day to spread the message about the importance of science in our daily lives. It aims to encourage the youth to develop a scientific temper and explore how innovation can solve global challenges.",
    "python": "Python is a high-level, interpreted programming language known for its simplicity and readability. It is the most popular choice today for AI and Data Science.",
    "computer": "A computer is a sophisticated electronic device that processes data according to a set of instructions. It performs the Input-Process-Output cycle to provide useful information.",

    // --- HINDI ---
    "à¤µà¤¿à¤œà¥à¤žà¤¾à¤¨ à¤¦à¤¿à¤µà¤¸": "à¤°à¤¾à¤·à¥à¤Ÿà¥à¤°à¥€à¤¯ à¤µà¤¿à¤œà¥à¤žà¤¾à¤¨ à¤¦à¤¿à¤µà¤¸ à¤¹à¤° à¤¸à¤¾à¤² 28 à¤«à¤°à¤µà¤°à¥€ à¤•à¥‹ à¤¸à¤° à¤¸à¥€.à¤µà¥€. à¤°à¤®à¤¨ à¤¦à¥à¤µà¤¾à¤°à¤¾ 'à¤°à¤®à¤¨ à¤ªà¥à¤°à¤­à¤¾à¤µ' à¤•à¥€ à¤–à¥‹à¤œ à¤•à¥€ à¤¯à¤¾à¤¦ à¤®à¥‡à¤‚ à¤®à¤¨à¤¾à¤¯à¤¾ à¤œà¤¾à¤¤à¤¾ à¤¹à¥ˆà¥¤ à¤‡à¤¸à¤•à¤¾ à¤®à¥à¤–à¥à¤¯ à¤‰à¤¦à¥à¤¦à¥‡à¤¶à¥à¤¯ à¤¯à¥à¤µà¤¾à¤“à¤‚ à¤®à¥‡à¤‚ à¤µà¥ˆà¤œà¥à¤žà¤¾à¤¨à¤¿à¤• à¤¸à¥‹à¤š à¤•à¥‹ à¤¬à¤¢à¤¼à¤¾à¤µà¤¾ à¤¦à¥‡à¤¨à¤¾ à¤¹à¥ˆà¥¤",
    "à¤•à¥à¤¯à¥‹à¤‚ à¤®à¤¨à¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚": "à¤¹à¤® à¤µà¤¿à¤œà¥à¤žà¤¾à¤¨ à¤¦à¤¿à¤µà¤¸ à¤‡à¤¸à¤²à¤¿à¤ à¤®à¤¨à¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤¤à¤¾à¤•à¤¿ à¤²à¥‹à¤—à¥‹à¤‚ à¤•à¥‡ à¤œà¥€à¤µà¤¨ à¤®à¥‡à¤‚ à¤µà¤¿à¤œà¥à¤žà¤¾à¤¨ à¤•à¥‡ à¤®à¤¹à¤¤à¥à¤µ à¤•à¥‹ à¤¸à¤®à¤à¤¾à¤¯à¤¾ à¤œà¤¾ à¤¸à¤•à¥‡ à¤”à¤° à¤¨à¤ˆ à¤ªà¥€à¤¢à¤¼à¥€ à¤•à¥‹ à¤¶à¥‹à¤§ à¤”à¤° à¤–à¥‹à¤œ à¤•à¥‡ à¤²à¤¿à¤ à¤ªà¥à¤°à¥‡à¤°à¤¿à¤¤ à¤•à¤¿à¤¯à¤¾ à¤œà¤¾ à¤¸à¤•à¥‡à¥¤",
    "à¤•à¤‚à¤ªà¥à¤¯à¥‚à¤Ÿà¤°": "à¤•à¤‚à¤ªà¥à¤¯à¥‚à¤Ÿà¤° à¤à¤• à¤‡à¤²à¥‡à¤•à¥à¤Ÿà¥à¤°à¥‰à¤¨à¤¿à¤• à¤‰à¤ªà¤•à¤°à¤£ à¤¹à¥ˆ à¤œà¥‹ à¤¡à¥‡à¤Ÿà¤¾ à¤•à¥‹ à¤‡à¤¨à¤ªà¥à¤Ÿ à¤•à¥‡ à¤°à¥‚à¤ª à¤®à¥‡à¤‚ à¤²à¥‡à¤¤à¤¾ à¤¹à¥ˆ, à¤‰à¤¸à¥‡ à¤ªà¥à¤°à¥‹à¤¸à¥‡à¤¸ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤”à¤° à¤‰à¤ªà¤¯à¥‹à¤—à¥€ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤†à¤‰à¤Ÿà¤ªà¥à¤Ÿ à¤•à¥‡ à¤°à¥‚à¤ª à¤®à¥‡à¤‚ à¤¦à¥‡à¤¤à¤¾ à¤¹à¥ˆà¥¤",
    "à¤¨à¤®à¤¸à¥à¤¤à¥‡": "à¤¨à¤®à¤¸à¥à¤¤à¥‡! à¤®à¥ˆà¤‚ à¤†à¤ªà¤•à¥€ à¤•à¥ˆà¤¸à¥‡ à¤®à¤¦à¤¦ à¤•à¤° à¤¸à¤•à¤¤à¤¾ à¤¹à¥‚à¤?",

    // --- TELUGU ---
    "à°¸à±ˆà°¨à±à°¸à± à°¡à±‡": "à°¸à°°à± à°¸à°¿.à°µà°¿. à°°à°¾à°®à°¨à± 1928 à°«à°¿à°¬à±à°°à°µà°°à°¿ 28à°¨ 'à°°à°¾à°®à°¨à± à°Žà°«à±†à°•à±à°Ÿà±'à°¨à± à°•à°¨à±à°—à±Šà°¨à±à°¨à°‚à°¦à±à°•à± à°—à±à°°à±à°¤à±à°—à°¾ à°ªà±à°°à°¤à°¿ à°¸à°‚à°µà°¤à±à°¸à°°à°‚ à°œà°¾à°¤à±€à°¯ à°¸à±ˆà°¨à±à°¸à± à°¦à°¿à°¨à±‹à°¤à±à°¸à°µà°¾à°¨à±à°¨à°¿ à°œà°°à±à°ªà±à°•à±à°‚à°Ÿà°¾à°°à±.",
    "à°Žà°‚à°¦à±à°•à± à°œà°°à±à°ªà±à°•à±à°‚à°Ÿà°¾à°®à±": "à°ªà±à°°à°œà°² à°°à±‹à°œà±à°µà°¾à°°à±€ à°œà±€à°µà°¿à°¤à°‚à°²à±‹ à°¸à±ˆà°¨à±à°¸à± à°ªà±à°°à°¾à°®à±à°–à±à°¯à°¤ à°—à±à°°à°¿à°‚à°šà°¿ à°…à°µà°—à°¾à°¹à°¨ à°•à°²à±à°ªà°¿à°‚à°šà°¡à°¾à°¨à°¿à°•à°¿ à°®à°°à°¿à°¯à± à°¯à±à°µà°¤à°²à±‹ à°¶à°¾à°¸à±à°¤à±à°°à±€à°¯ à°¦à±ƒà°•à±à°ªà°¥à°¾à°¨à±à°¨à°¿ à°ªà±†à°‚à°ªà±Šà°‚à°¦à°¿à°‚à°šà°¡à°¾à°¨à°¿à°•à°¿ à°®à°¨à°‚ à°¸à±ˆà°¨à±à°¸à± à°¡à±‡à°¨à°¿ à°œà°°à±à°ªà±à°•à±à°‚à°Ÿà°¾à°®à±.",
    "à°•à°‚à°ªà±à°¯à±‚à°Ÿà°°à±": "à°•à°‚à°ªà±à°¯à±‚à°Ÿà°°à± à°…à°¨à±‡à°¦à°¿ à°¸à°®à°¾à°šà°¾à°°à°¾à°¨à±à°¨à°¿ à°ªà±à°°à°¾à°¸à±†à°¸à± à°šà±‡à°¸à±‡ à°’à°• à°Žà°²à°•à±à°Ÿà±à°°à°¾à°¨à°¿à°•à± à°ªà°°à°¿à°•à°°à°‚.",
    "à°¨à°®à°¸à±à°•à°¾à°°à°‚": "à°¨à°®à°¸à±à°•à°¾à°°à°‚! à°¨à±‡à°¨à± à°®à±€à°•à± à°Žà°²à°¾ à°¸à°¹à°¾à°¯à°ªà°¡à°—à°²à°¨à±?"
};

let isMuted = false;

// 1. VOICE OUTPUT
function speak(text) {
    if (isMuted) return;
    window.speechSynthesis.cancel();
    const utterance = new SpeechSynthesisUtterance(text);
    if (/[à°¹-à±¯]/.test(text)) utterance.lang = 'te-IN'; 
    else if (/[à¤…-à¤¹]/.test(text)) utterance.lang = 'hi-IN'; 
    else utterance.lang = 'en-IN'; 
    window.speechSynthesis.speak(utterance);
}

// 2. MIC INPUT
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
if (SpeechRecognition) {
    const recognition = new SpeechRecognition();
    recognition.lang = 'en-IN';
    function startVoice() {
        document.querySelector(".mic-btn").style.color = "red";
        recognition.start();
    }
    recognition.onresult = (event) => {
        document.getElementById("userInput").value = event.results[0][0].transcript;
        handleSend();
    };
    recognition.onspeechend = () => { recognition.stop(); document.querySelector(".mic-btn").style.color = "inherit"; };
    recognition.onerror = () => { document.querySelector(".mic-btn").style.color = "inherit"; };
}

// 3. LOGIC
function getResponse(userInput) {
    const text = userInput.trim();
    const textLower = text.toLowerCase();
    const isHindi = /[à¤…-à¤¹]/.test(text);
    const isTelugu = /[à°¹-à±¯]/.test(text);

    for (let key in Knowledge) {
        if (textLower.includes(key.toLowerCase())) return Knowledge[key];
    }

    if (textLower.includes("why") || textLower.includes("à¤•à¥à¤¯à¥‹à¤‚") || textLower.includes("à°Žà°‚à°¦à±à°•à±")) {
        if (isHindi) return Knowledge["à¤•à¥à¤¯à¥‹à¤‚ à¤®à¤¨à¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚"];
        if (isTelugu) return Knowledge["à°Žà°‚à°¦à±à°•à± à°œà°°à±à°ªà±à°•à±à°‚à°Ÿà°¾à°®à±"];
        return Knowledge["why we celebrate"];
    }

    if (isHindi) return `à¤•à¥à¤·à¤®à¤¾ à¤•à¤°à¥‡à¤‚, à¤®à¥à¤à¥‡ "${text}" à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆà¥¤`;
    if (isTelugu) return `à°•à±à°·à°®à°¿à°‚à°šà°‚à°¡à°¿, à°¨à°¾ à°¦à°—à±à°—à°° "${text}" à°—à±à°°à°¿à°‚à°šà°¿ à°¸à°®à°¾à°šà°¾à°°à°‚ à°²à±‡à°¦à±.`;
    return "I'm still learning! Try asking about Science Day or Python.";
}

// 4. UI FUNCTIONS
function handleSend() {
    const inputField = document.getElementById("userInput");
    const val = inputField.value.trim();
    if (!val) return;

    renderMessage(val, 'user-msg');
    inputField.value = "";
    document.getElementById("typing").classList.remove("hidden");

    setTimeout(() => {
        document.getElementById("typing").classList.add("hidden");
        const reply = getResponse(val);
        renderMessage(reply, 'bot-msg');
        speak(reply);
    }, 600);
}

function renderMessage(txt, type) {
    const chatbox = document.getElementById("chatbox");
    const div = document.createElement("div");
    div.className = `msg ${type}`;
    div.innerText = txt;
    chatbox.appendChild(div);
    chatbox.scrollTop = chatbox.scrollHeight;
}

function clearChat() {
    document.getElementById("chatbox").innerHTML = '<div class="msg bot-msg">Chat cleared. How can I help you?</div>';
}

function toggleTheme() { document.body.classList.toggle('dark-mode'); }
function toggleMute() {
    isMuted = !isMuted;
    document.getElementById("muteBtn").innerText = isMuted ? "ðŸ”‡" : "ðŸ”Š";
}

document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("userInput").addEventListener("keypress", (e) => {
        if (e.key === "Enter") handleSend();
    });
});
